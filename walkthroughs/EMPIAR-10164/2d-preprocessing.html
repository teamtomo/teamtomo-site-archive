
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>2D preprocessing</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/tabs.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"Macros": {"N": "\\mathbb{N}", "floor": ["\\lfloor#1\\rfloor", 1], "bmat": ["\\left[\\begin{array}"], "emat": ["\\end{array}\\right]"]}}, "tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Tilt-series to tomograms" href="tilt-series-to-tomograms.html" />
    <link rel="prev" title="Download the data" href="preparation.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      <img src="../../_static/logo.svg" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <p class="caption">
 <span class="caption-text">
  teamtomo.org
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../teamtomo/about.html">
   About the project
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../teamtomo/contributing/index.html">
   Contributing
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../teamtomo/contributing/git_guide.html">
     A short guide to git(hub)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../teamtomo/contributing/screen-capture.html">
     Screen capture
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../teamtomo/contributing/wishlist.html">
     Wishlist
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Theory
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../theory/cryo-et/index.html">
   Cryo-electron tomography
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../theory/cryo-et/tilt-schemes.html">
     Tilt-schemes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../theory/cryo-et/tilt-series-alignment.html">
     Tilt-series alignment
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../theory/subtomogram-averaging/index.html">
   Subtomogram averaging
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../theory/subtomogram-averaging/preprocessing/index.html">
     Preprocessing
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../theory/subtomogram-averaging/particle-picking/index.html">
     Particle picking
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../theory/subtomogram-averaging/particle-picking/template-matching.html">
       Template matching
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../theory/subtomogram-averaging/particle-picking/geometrical-supports.html">
       Using a supporting geometry
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../theory/subtomogram-averaging/particle-picking/subboxing.html">
       Subboxing
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../theory/subtomogram-averaging/refinement/index.html">
     Refinement
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../theory/image-processing/introduction.html">
   Image processing
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Walkthroughs
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="introduction.html">
   EMPIAR-10164 (HIV VLPs)
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="preparation.html">
     Download the data
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     2D preprocessing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tilt-series-to-tomograms.html">
     Tilt-series to tomograms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="geometrical-picking.html">
     Geometrical particle picking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ini-model.html">
     Initial model generation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="particle-picking.html">
     Find particles on every VLP
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="relion.html">
     Particle pose optimisation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="m.html">
     Multi-particle refinement
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  mini-tutorials
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../mini-tutorials/dynamo/index.html">
   Dynamo
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../mini-tutorials/dynamo/simple-alignment.html">
     Simple subtomogram averaging
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../mini-tutorials/dynamo/extract-from-catalogue.html">
     Extracting particles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../mini-tutorials/dynamo/dipoles-to-vesicles.html">
     Spherical vesicle picking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../mini-tutorials/dynamo/dtmslice-controls.html">
     <code class="docutils literal notranslate">
      <span class="pre">
       dtmslice
      </span>
     </code>
     viewing controls
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../mini-tutorials/dynamo/interactive-mask-creation.html">
     Interactive mask creation
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  computing
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../computing/python/index.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computing/python/getting-started.html">
     Getting started
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computing/python/virtual-environments.html">
     Virtual environments
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../computing/python/useful-packages/useful-packages.html">
     Useful packages
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
    <label for="toctree-checkbox-8">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../computing/python/useful-packages/dynamotable.html">
       dynamotable
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../computing/python/useful-packages/emfile.html">
       emfile
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../computing/python/useful-packages/eulerangles.html">
       eulerangles
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../computing/python/useful-packages/mrcfile.html">
       mrcfile
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../computing/python/useful-packages/napari.html">
       napari
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../computing/python/useful-packages/starfile.html">
       starfile
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../computing/matlab/index.html">
   MATLAB
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computing/matlab/add-to-path.html">
     Adding scripts/functions to your PATH in
     <code class="docutils literal notranslate">
      <span class="pre">
       MATLAB
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Resources
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../resources/literature/index.html">
   Literature
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/literature/protocols/protocols.html">
     Protocols
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../resources/literature/reviews/reviews.html">
     Reviews
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
    <label for="toctree-checkbox-11">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/literature/reviews/schur19.html">
       Schur - 2019
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/literature/reviews/lucic08.html">
       Lučić - 2008
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/literature/reviews/lucic05.html">
       Lučić - 2005
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../resources/literature/book-chapters/book-chapters.html">
     Book chapters
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
    <label for="toctree-checkbox-12">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/literature/book-chapters/subtomo-leigh19.html">
       Subtomogram averaging from cryo-electron tomograms - Leigh 2019
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/literature/book-chapters/cryo-et-sta-wan16.html">
       Cryo-Electron Tomography and Subtomogram Averaging - Wan 2016
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/literature/book-chapters/fiducial-alignments-mastronarde07.html">
       Fiducial Marker and Hybrid Alignment Methods for Single- and Double-axis Tomography - Mastronarde 2007
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../resources/cryoet-software/cryoet-software.html">
   Software packages
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/cryoet-software/appion-protomo/appion-protomo.html">
     Appion-Protomo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/cryoet-software/cryolo/cryolo.html">
     crYOLO
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../resources/cryoet-software/dynamo/dynamo.html">
     Dynamo
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
    <label for="toctree-checkbox-14">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/cryoet-software/dynamo/starters-guide.html">
       Starters guide
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/cryoet-software/dynamo/advanced-starters-guide.html">
       Advanced starters guide
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/cryoet-software/dynamo/tilt-series-alignment.html">
       Tilt-series alignment
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/cryoet-software/dynamo/PCA.html">
       PCA based classification
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../resources/cryoet-software/eman2/eman2.html">
     EMAN2
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
    <label for="toctree-checkbox-15">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/cryoet-software/eman2/full-tutorial.html">
       Complete tutorial
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/cryoet-software/eman2/segmentation.html">
       Neural-net based segmentation
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../resources/cryoet-software/emclarity/emclarity.html">
     emClarity
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
    <label for="toctree-checkbox-16">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/cryoet-software/emclarity/tutorial.html">
       tutorial
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../resources/cryoet-software/imod/imod.html">
     IMOD
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
    <label for="toctree-checkbox-17">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/cryoet-software/imod/tomo-guide.html">
       Tomography guide
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/cryoet-software/imod/etomo-fiducial-tuto.html">
       Etomo with fiducials
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/cryoet-software/imod/etomo-patch-track-tuto.html">
       Patch tracking in Etomo
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/cryoet-software/imod/batch-alignment.html">
       Batch tilt-series alignment
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../resources/cryoet-software/m/m.html">
     M
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
    <label for="toctree-checkbox-18">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/cryoet-software/m/user-guide.html">
       Warp/M
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/cryoet-software/novactf/novactf.html">
     NovaCTF
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/cryoet-software/novasta/novasta.html">
     NovaSTA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/cryoet-software/pytom/pytom.html">
     PyTom
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/cryoet-software/relion/relion.html">
     RELION
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/cryoet-software/stopgap/stopgap.html">
     STOPGAP
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../resources/cryoet-software/warp/warp.html">
     Warp
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
    <label for="toctree-checkbox-19">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/cryoet-software/warp/user-guide.html">
       Warp/M
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/walkthroughs/EMPIAR-10164/2d-preprocessing.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/teamtomo/teamtomo.github.io"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/teamtomo/teamtomo.github.io/issues/new?title=Issue%20on%20page%20%2Fwalkthroughs/EMPIAR-10164/2d-preprocessing.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/teamtomo/teamtomo.github.io/edit/master/./walkthroughs/EMPIAR-10164/2d-preprocessing.md"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#raw-data-preprocessing-in-warp">
   Raw data preprocessing in Warp
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#deselect-bad-images">
   Deselect bad images
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#stack-generation">
   Stack generation
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="d-preprocessing">
<span id="hiv-mic-preproc"></span><h1>2D preprocessing<a class="headerlink" href="#d-preprocessing" title="Permalink to this headline">¶</a></h1>
<p>In this section we will take you from the raw data we downloaded from <em>EMPIAR</em> (multi-frame micrographs) to tilt-series.</p>
<p>We will use <code class="docutils literal notranslate"><span class="pre">Warp</span></code> for the initial processing of the raw data. This will let us:</p>
<ul class="simple">
<li><p>obtain an initial estimate for defocus and inter-frame motion</p></li>
<li><p>merge frames into single images according on the estimated motion</p></li>
<li><p>detect and mask gold fiducials for tomogram reconstruction</p></li>
<li><p>prepare the image stacks for tilt-series alignment in <code class="docutils literal notranslate"><span class="pre">Dynamo</span></code></p></li>
</ul>
<div class="section" id="raw-data-preprocessing-in-warp">
<h2>Raw data preprocessing in Warp<a class="headerlink" href="#raw-data-preprocessing-in-warp" title="Permalink to this headline">¶</a></h2>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>The following tabs detail the parameter settings as appropriate for this application. If you seek additional information, check out the <a class="reference external" href="http://www.warpem.com/warp/?page_id=51">Warp User Guide</a>.</p>
</div>
<div class="sphinx-bs container pb-4 docutils">
<div class="row docutils">
<div class="d-flex col-20 docutils">
<div class="card w-100 border-2 docutils">
<div class="card-body docutils">
<div class="tabbed-set docutils">
<input checked="checked" id="40752112-d2c8-4493-a69e-1741c5389e55" name="4cedf644-f438-4937-b0fd-85e9cce898a0" type="radio">
</input><label class="tabbed-label" for="40752112-d2c8-4493-a69e-1741c5389e55">
Import</label><div class="tabbed-content docutils">
<p class="card-text">To import new data into Warp, click on the path next to <code class="docutils literal notranslate"><span class="pre">Input</span></code> and select the <code class="docutils literal notranslate"><span class="pre">frames</span></code> directory. For the HIV-5-TS data, make sure that the selected format is <code class="docutils literal notranslate"><span class="pre">*.mrc</span></code>.</p>
<p class="card-text">We then set the parameters as shown below.</p>
<a class="reference internal image-reference" href="../../_images/input-params.png"><img alt="../../_images/input-params.png" src="../../_images/input-params.png" style="width: 400px;" /></a>
<p class="card-text">We need to correctly set the pixel size to match that of the raw data; in this case, 0.6750 <span class="math notranslate nohighlight">\(Å/px\)</span>.</p>
<div class="margin sidebar">
<p class="card-title sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p class="card-text">With a binning factor of <em>n</em>, the frames will be Fourier-cropped to <span class="math notranslate nohighlight">\(size/2^n\)</span>.</p>
</div>
</div>
<p class="card-text">For HIV-5-TS, the data were collected in super resolution mode, the physical pixel size is 1.35 <span class="math notranslate nohighlight">\(Å/px\)</span>. Processing data without first downsampling may reduce the aliasing of high-frequency signals in the image but significantly increases the computational overhead. In this case we will use Warp to downsample the data by a factor of 2, in order to return to the physical pixel size of the detector. For now, the exposure can be left at zero. For tilt-series data, dose-dependent exposure weighting (dose-weighting) is dealt with at a later stage.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p class="card-text">When processing other data, you may need to provide a gain reference here.
Make sure that the orientation of the reference and the images correspond!</p>
</div>
<p class="card-text">The EMPIAR entry for EMPIAR-10164 indicates that the images were already gain corrected. We can skip gain correction by leaving this section unchecked.</p>
</div>
<input id="15b99a26-41a3-4750-9d0f-79f1a46da545" name="4cedf644-f438-4937-b0fd-85e9cce898a0" type="radio">
</input><label class="tabbed-label" for="15b99a26-41a3-4750-9d0f-79f1a46da545">
CTF and Motion</label><div class="tabbed-content docutils">
<div class="margin sidebar">
<p class="card-title sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p class="card-text">The CTF estimation performed at this stage is only used for tilt handedness evaluation;
we will explain this in more detail later.</p>
</div>
</div>
<p class="card-text">Accurate estimation of Contrast Transfer Function (CTF) parameters is essential for obtaining high resolution reconstructions.</p>
<a class="reference internal image-reference" href="../../_images/ctf-params.png"><img alt="../../_images/ctf-params.png" src="../../_images/ctf-params.png" style="width: 400px;" /></a>
<p class="card-text">The following parameters depend entirely on the microscope setup used for data collection, for HIV-5-TS:</p>
<div class="sphinx-bs container pb-4 docutils">
<div class="row docutils">
<div class="d-flex col-20 docutils">
<div class="card w-100 border-2 docutils">
<div class="card-body docutils">
<p class="card-text">Voltage
: The acceleration voltage used in the electron microscope</p>
<p class="card-text">Cs
: The spherical aberration of the electron microscope</p>
<p class="card-text">Phase Shift
: Whether to model a phase shift in the CTF, usually only used for data collected with a phase plate.</p>
</div>
</div>
</div>
</div>
</div>
<p class="card-text">The remaining parameters should be set depending on the dataset:</p>
<div class="sphinx-bs container pb-4 docutils">
<div class="row docutils">
<div class="d-flex col-20 docutils">
<div class="card w-100 border-2 docutils">
<div class="card-body docutils">
<p class="card-text">Defocus
: The upper and lower limits for defocus estimation. When a dataset is expected to have higher or lower defoci, this range should be expanded.</p>
<p class="card-text">Use Movie Sum
: Whether to use the movie sum for CTF parameter estimation. Activating this should lead to slightly better results for low-dose images.</p>
<p class="card-text">Amplitude
: The percentage of amplitude contrast for the CTF model. For cryo-EM typical values are 0.07-0.10.</p>
</div>
</div>
</div>
</div>
</div>
<p class="card-text">Some computational parameters can also be adjusted:</p>
<div class="sphinx-bs container pb-4 docutils">
<div class="row docutils">
<div class="d-flex col-20 docutils">
<div class="card w-100 border-2 docutils">
<div class="card-body docutils">
<p class="card-text">Window
: The size of power spectra used for CTF estimation.</p>
<p class="card-text">Range
: The range of spatial frequencies to use for fitting. At low frequencies, data often doesn’t match the CTF model. At high frequencies there is often not enough signal for accurate CTF estimation. In our experience, 40.0-5.0 is usually a good range for high magnification tilt-series images (1-3  <span class="math notranslate nohighlight">\(Å/px\)</span>) with ca. 3 <span class="math notranslate nohighlight">\(e^-/Å^2/tilt\)</span> image.</p>
</div>
</div>
</div>
</div>
</div>
<p class="card-text">In order to compensate for both mechanical stage-drift and beam-induced sample motion,
we estimate and correct for the inter-frame motion present in the image.
In this case, we leave the motion correction parameters as defaults.</p>
<a class="reference internal image-reference" href="../../_images/motion-params.png"><img alt="../../_images/motion-params.png" src="../../_images/motion-params.png" style="width: 400px;" /></a>
</div>
<input id="637ff4bb-5db8-4e62-93ee-39acf90a3ada" name="4cedf644-f438-4937-b0fd-85e9cce898a0" type="radio">
</input><label class="tabbed-label" for="637ff4bb-5db8-4e62-93ee-39acf90a3ada">
Spatiotemporal models</label><div class="tabbed-content docutils">
<p class="card-text">Warp allows us to estimate how CTF and inter-frame translational motion parameters change in both space and time.</p>
<a class="reference internal image-reference" href="../../_images/spatiotemporal-models.png"><img alt="../../_images/spatiotemporal-models.png" src="../../_images/spatiotemporal-models.png" style="width: 400px;" /></a>
<p class="card-text">The resolution of this spatiotemporal model (x, y, t) can be set in the <strong>Models</strong> panel: the first two values represent the spatial resolution of the model in <em>x</em> and <em>y</em> , while the third value sets the temporal resolution (at most, the number of frames in a multi-frame micrograph).</p>
<p class="card-text">For tilt-series data, a CTF model resolution of 2x2x1 is usually sufficient to observe how defocus changes across the image, which is required to determine the ‘tilt-handedness’ of the data. More accurate defocus values will be estimated in the tilt-series CTF estimation procedure prior to tomogram reconstruction.</p>
<p class="card-text">A motion model of 1x1xn where n is the number of frames typically ensures that accurate estimates can be obtained from low-dose data. The alignment of individual frames can be improved once a high SNR reference has been obtained, this is performed in the multi-particle refinement step of the workflow.</p>
<p class="card-text">For HIV-5-TS, EMPIAR indicates that we have 8 frames per image, so we set the resolution of the motion model to 1x1x8</p>
</div>
<input id="46f98313-4e1e-4739-b6a5-83226fadbd4f" name="4cedf644-f438-4937-b0fd-85e9cce898a0" type="radio">
</input><label class="tabbed-label" for="46f98313-4e1e-4739-b6a5-83226fadbd4f">
Fiducials</label><div class="tabbed-content docutils">
<p class="card-text">While gold fiducials are useful for the accurate alignment of tilt series, their high contrast will have negative effects on the final tomographic reconstruction. For this reason, we use Warp to mask out any beads prior to tomographic reconstruction.</p>
<p class="card-text">The <code class="docutils literal notranslate"><span class="pre">Pick</span> <span class="pre">Particles</span></code> panel gives access to <code class="docutils literal notranslate"><span class="pre">BoxNet</span></code>, a deep convolutional neural network designed to pick particles and mask out unwanted subregions in single-particle cryo-EM. A version of <code class="docutils literal notranslate"><span class="pre">BoxNet</span></code> that we retrained to mask gold fiducials <a class="reference external" href="https://doi.org/10.5281/zenodo.4486376">is available here</a> under the name <code class="docutils literal notranslate"><span class="pre">GoldNet</span></code>.</p>
<div class="margin sidebar">
<p class="card-title sidebar-title"></p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p class="card-text">GoldNet was retrained on 3 tilt series from a high magnification dataset (1.7 <span class="math notranslate nohighlight">\(Å/px\)</span>) containing 10 <span class="math notranslate nohighlight">\(nm\)</span> gold beads. We have succesfully used it on a variety of datasets, but there is no guaranteee it will work on yours. To learn more about retraining BoxNet, <a class="reference external" href="http://www.multiparticle.com/warp/?page_id=137">see this page</a>.</p>
</div>
</div>
<p class="card-text">In order to access it from Warp, extract the <code class="docutils literal notranslate"><span class="pre">GoldNet</span></code> directory and place it in the Warp installation folder under the <code class="docutils literal notranslate"><span class="pre">boxnet2models</span></code> directory. Then, to select the pretrained model in Warp, click on the currently selected BoxNet model and select the <code class="docutils literal notranslate"><span class="pre">GoldNet</span></code> model.</p>
<a class="reference internal image-reference" href="../../_images/boxnet-params.png"><img alt="../../_images/boxnet-params.png" src="../../_images/boxnet-params.png" style="width: 400px;" /></a>
<p class="card-text">As we are only using this model for particle picking, the parameters relating to particle picking can be safely ignored.</p>
</div>
<input id="b639102a-70c5-4e73-ae72-576998a96c49" name="4cedf644-f438-4937-b0fd-85e9cce898a0" type="radio">
</input><label class="tabbed-label" for="b639102a-70c5-4e73-ae72-576998a96c49">
Start Processing!</label><div class="tabbed-content docutils">
<a class="reference internal image-reference" href="../../_images/output-params.png"><img alt="../../_images/output-params.png" src="../../_images/output-params.png" style="width: 400px;" /></a>
<p class="card-text">In the <code class="docutils literal notranslate"><span class="pre">Output</span></code> panel, we can choose not to include frames at the beginning and end of a movie. The first frames from a multi-frame micrograph of a given exposure often display increased translational motion. In this case, we chose to include all frames from the micrograph to maximise the signal present in the final images.</p>
<p class="card-text">By selecting <code class="docutils literal notranslate"><span class="pre">Average</span></code>, we ensure the output of one 2D image per multi-frame micrograph in which the inter-frame motion has been corrected according to the motion model</p>
<p class="card-text"><code class="docutils literal notranslate"><span class="pre">Odd/even</span></code> frame averages can be generated to facilitate Noise2Noise based denoising, this is not covered in this guide but we recommend playing with it.</p>
<p class="card-text"><code class="docutils literal notranslate"><span class="pre">Aligned</span> <span class="pre">stack</span></code>s of frames can also be generated; this can be useful in single-particle analysis of frame series data to enable the use of RELION’s Bayesian polishing. In our case, we leave it blank.</p>
<p class="card-text">We are now ready to press <strong>START PROCESSING</strong>. This will:</p>
<ul class="simple">
<li><p class="card-text">Estimate CTF and inter-frame motion parameters according to the spatiotemporal model</p></li>
<li><p class="card-text">Generate one micrograph per tilt in which the motion has been corrected according to the motion model</p></li>
<li><p class="card-text">Generate masks around gold fiducials in each image using the provided BoxNet model</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p class="card-text">During processing, you can check the results by switching to the <code class="docutils literal notranslate"><span class="pre">Real</span> <span class="pre">Space</span></code> and <code class="docutils literal notranslate"><span class="pre">Fourier</span> <span class="pre">Space</span></code> tabs at the top of the Warp interface. Explore these sections, checking that the CTF model matches the experimental curve, the defocus estimates appear to change as expected with tilt angle and that beads masks seem appropriate.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="deselect-bad-images">
<h2>Deselect bad images<a class="headerlink" href="#deselect-bad-images" title="Permalink to this headline">¶</a></h2>
<p>Images in each tilt-series must be assembled into an <code class="docutils literal notranslate"><span class="pre">IMOD</span></code> stack in order to use <code class="docutils literal notranslate"><span class="pre">Dynamo</span></code> for the tilt-series alignment, but before doing so we should discard any bad images in our dataset. To do so, switch to the <code class="docutils literal notranslate"><span class="pre">Real</span> <span class="pre">Space</span></code> tab at the top and manually inspect all the tilt images.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>With larger datasets, quickly scanning images in this way can be inconvenient. To make this a bit easier, use the search bar to display only a subset of the dataset (For HIV-5-TS we could search <code class="docutils literal notranslate"><span class="pre">TS_01</span></code>, <code class="docutils literal notranslate"><span class="pre">TS_02</span></code>…)</p>
</div>
</div>
<p>To quickly check the images, hover your mouse over the selection bar at the bottom of the screen and move it along its length to inspect the thumbnails. To inspect an image in more detail, click on the bar and the image will be enlarged.</p>
<p>If an image is heavily contaminated, black, blurred, a grid bar blocks a significant part of it or you otherwise deem it unsuitable, deselect the image by clicking the checkbox next to its name. The bar should turn grey once an image is deselected.</p>
<p>For this dataset we only have to discard two bad images: <code class="docutils literal notranslate"><span class="pre">TS_01_039</span></code> and <code class="docutils literal notranslate"><span class="pre">TS_03_039</span></code>.</p>
<a class="reference internal image-reference" href="../../_images/deselect-bad-image.png"><img alt="../../_images/deselect-bad-image.png" src="../../_images/deselect-bad-image.png" style="width: 400px;" /></a>
</div>
<div class="section" id="stack-generation">
<h2>Stack generation<a class="headerlink" href="#stack-generation" title="Permalink to this headline">¶</a></h2>
<p>To generate the image stack, we first have to put Warp into <code class="docutils literal notranslate"><span class="pre">tomostar</span></code> mode. We do this by clicking on the <code class="docutils literal notranslate"><span class="pre">*.mrc</span></code> extension on the top left, and selecting the <code class="docutils literal notranslate"><span class="pre">*.tomostar</span></code> extension.</p>
<p>Then, click on the (slightly misnamed) <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">tilt</span> <span class="pre">series</span> <span class="pre">from</span> <span class="pre">IMOD</span></code> button at the top of the screen.
In the newly opened window, we should now select the <code class="docutils literal notranslate"><span class="pre">Folder</span> <span class="pre">with</span> <span class="pre">original</span> <span class="pre">movies</span></code> and the <code class="docutils literal notranslate"><span class="pre">Folder</span> <span class="pre">with</span> <span class="pre">.mdoc</span> <span class="pre">files</span></code>.
In this case, they are the <code class="docutils literal notranslate"><span class="pre">frames</span></code> and <code class="docutils literal notranslate"><span class="pre">mdoc</span></code> folders, respectively.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For now, we don’t need to set the pixel size and electron dose per tilt, nor we need to worry about inverting tilt angles. We will set all these parameters at a later stage.</p>
</div>
</div>
<p>Click on <code class="docutils literal notranslate"><span class="pre">Create</span> <span class="pre">stacks</span> <span class="pre">for</span> <span class="pre">IMOD</span></code> to start exporting the data. We can immediately move on to the next step without having to wait for the stack generation to finish, thanks to <code class="docutils literal notranslate"><span class="pre">autoalign_dynamo</span></code>’s on-the-fly processing.</p>
<a class="reference internal image-reference" href="../../_images/create-stack.png"><img alt="../../_images/create-stack.png" src="../../_images/create-stack.png" style="width: 600px;" /></a>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./walkthroughs/EMPIAR-10164"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="preparation.html" title="previous page">Download the data</a>
    <a class='right-next' id="next-link" href="tilt-series-to-tomograms.html" title="next page">Tilt-series to tomograms</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By the teamtomo.org contributors<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>