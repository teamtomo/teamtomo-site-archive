
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Find particles on every VLP</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/tabs.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Particle pose optimisation" href="relion.html" />
    <link rel="prev" title="Initial model generation" href="ini-model.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      <img src="../../_static/logo.svg" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <p class="caption">
 <span class="caption-text">
  teamtomo.org
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../teamtomo/about.html">
   About the project
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../teamtomo/contributing/index.html">
   Contributing
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../teamtomo/contributing/git_guide.html">
     A short guide to git(hub)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../teamtomo/contributing/screen-capture.html">
     Screen capture
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../teamtomo/contributing/wishlist.html">
     Wishlist
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Theory
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../theory/cryo-et/index.html">
   Cryo-electron tomography
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../theory/cryo-et/tilt-schemes.html">
     Tilt-schemes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../theory/cryo-et/tilt-series-alignment.html">
     Tilt-series alignment
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../theory/subtomogram-averaging/index.html">
   Subtomogram averaging
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../theory/subtomogram-averaging/preprocessing/index.html">
     Preprocessing
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../theory/subtomogram-averaging/particle-picking/index.html">
     Particle picking
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../theory/subtomogram-averaging/particle-picking/template-matching.html">
       Template matching
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../theory/subtomogram-averaging/particle-picking/geometrical-supports.html">
       Using a supporting geometry
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../theory/subtomogram-averaging/particle-picking/subboxing.html">
       Subboxing
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../theory/subtomogram-averaging/refinement/index.html">
     Refinement
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../theory/image-processing/introduction.html">
   Image processing
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Walkthroughs
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="introduction.html">
   EMPIAR-10164 (HIV VLPs)
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="preparation.html">
     Download the data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2d-preprocessing.html">
     2D preprocessing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tilt-series-to-tomograms.html">
     Tilt-series to tomograms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="geometrical-picking.html">
     Geometrical particle picking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ini-model.html">
     Initial model generation
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Find particles on every VLP
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="relion.html">
     Particle pose optimisation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="m.html">
     Multi-particle refinement
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  mini-tutorials
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../mini-tutorials/dynamo/index.html">
   Dynamo
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../mini-tutorials/dynamo/simple-alignment.html">
     Simple subtomogram averaging
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../mini-tutorials/dynamo/extract-from-catalogue.html">
     Extracting particles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../mini-tutorials/dynamo/dipoles-to-vesicles.html">
     Spherical vesicle picking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../mini-tutorials/dynamo/dtmslice-controls.html">
     <code class="docutils literal notranslate">
      <span class="pre">
       dtmslice
      </span>
     </code>
     viewing controls
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../mini-tutorials/dynamo/interactive-mask-creation.html">
     Interactive mask creation
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  computing
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../computing/python/index.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computing/python/getting-started.html">
     Getting started
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computing/python/virtual-environments.html">
     Virtual environments
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../computing/python/useful-packages/useful-packages.html">
     Useful packages
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
    <label for="toctree-checkbox-8">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../computing/python/useful-packages/dynamotable.html">
       dynamotable
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../computing/python/useful-packages/emfile.html">
       emfile
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../computing/python/useful-packages/eulerangles.html">
       eulerangles
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../computing/python/useful-packages/mrcfile.html">
       mrcfile
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../computing/python/useful-packages/napari.html">
       napari
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../computing/python/useful-packages/starfile.html">
       starfile
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../computing/matlab/index.html">
   MATLAB
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computing/matlab/add-to-path.html">
     Adding scripts/functions to your PATH in
     <code class="docutils literal notranslate">
      <span class="pre">
       MATLAB
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Resources
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../resources/literature/index.html">
   Literature
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/literature/protocols/protocols.html">
     Protocols
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../resources/literature/reviews/reviews.html">
     Reviews
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
    <label for="toctree-checkbox-11">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/literature/reviews/schur19.html">
       Schur - 2019
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/literature/reviews/lucic08.html">
       Lučić - 2008
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/literature/reviews/lucic05.html">
       Lučić - 2005
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../resources/literature/book-chapters/book-chapters.html">
     Book chapters
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
    <label for="toctree-checkbox-12">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/literature/book-chapters/subtomo-leigh19.html">
       Subtomogram averaging from cryo-electron tomograms - Leigh 2019
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/literature/book-chapters/cryo-et-sta-wan16.html">
       Cryo-Electron Tomography and Subtomogram Averaging - Wan 2016
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/literature/book-chapters/fiducial-alignments-mastronarde07.html">
       Fiducial Marker and Hybrid Alignment Methods for Single- and Double-axis Tomography - Mastronarde 2007
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../resources/cryoet-software/cryoet-software.html">
   Software packages
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/cryoet-software/appion-protomo/appion-protomo.html">
     Appion-Protomo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/cryoet-software/cryolo/cryolo.html">
     crYOLO
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../resources/cryoet-software/dynamo/dynamo.html">
     Dynamo
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
    <label for="toctree-checkbox-14">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/cryoet-software/dynamo/starters-guide.html">
       Starters guide
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/cryoet-software/dynamo/advanced-starters-guide.html">
       Advanced starters guide
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/cryoet-software/dynamo/tilt-series-alignment.html">
       Tilt-series alignment
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/cryoet-software/dynamo/PCA.html">
       PCA based classification
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../resources/cryoet-software/eman2/eman2.html">
     EMAN2
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
    <label for="toctree-checkbox-15">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/cryoet-software/eman2/full-tutorial.html">
       Complete tutorial
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/cryoet-software/eman2/segmentation.html">
       Neural-net based segmentation
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../resources/cryoet-software/emclarity/emclarity.html">
     emClarity
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
    <label for="toctree-checkbox-16">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/cryoet-software/emclarity/tutorial.html">
       tutorial
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../resources/cryoet-software/imod/imod.html">
     IMOD
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
    <label for="toctree-checkbox-17">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/cryoet-software/imod/tomo-guide.html">
       Tomography guide
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/cryoet-software/imod/etomo-fiducial-tuto.html">
       Etomo with fiducials
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/cryoet-software/imod/etomo-patch-track-tuto.html">
       Patch tracking in Etomo
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/cryoet-software/imod/batch-alignment.html">
       Batch tilt-series alignment
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../resources/cryoet-software/m/m.html">
     M
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
    <label for="toctree-checkbox-18">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/cryoet-software/m/user-guide.html">
       Warp/M
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/cryoet-software/novactf/novactf.html">
     NovaCTF
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/cryoet-software/novasta/novasta.html">
     NovaSTA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/cryoet-software/pytom/pytom.html">
     PyTom
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/cryoet-software/relion/relion.html">
     RELION
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/cryoet-software/stopgap/stopgap.html">
     STOPGAP
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../resources/cryoet-software/warp/warp.html">
     Warp
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
    <label for="toctree-checkbox-19">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../resources/cryoet-software/warp/user-guide.html">
       Warp/M
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/walkthroughs/EMPIAR-10164/particle-picking.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/teamtomo/teamtomo.github.io"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/teamtomo/teamtomo.github.io/issues/new?title=Issue%20on%20page%20%2Fwalkthroughs/EMPIAR-10164/particle-picking.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/teamtomo/teamtomo.github.io/edit/master/./walkthroughs/EMPIAR-10164/particle-picking.md"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#particle-extraction">
   Particle extraction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#particle-alignment">
   Particle alignment
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cleaning-the-dataset-based-on-geometrical-constraints">
   Cleaning the dataset based on geometrical constraints
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="find-particles-on-every-vlp">
<h1>Find particles on every VLP<a class="headerlink" href="#find-particles-on-every-vlp" title="Permalink to this headline">¶</a></h1>
<p><em>“What do we know and how can we use it?”</em></p>
<p>We now have</p>
<ul class="simple">
<li><p>initial estimates for the particle positions and orientations on the surface of every VLP</p></li>
<li><p>a good initial model centered on the 6-fold symmetry axis of the lattice structure.</p></li>
</ul>
<p>We can use this information to run a one iteration subtomogram averaging project. This should allow us to find a good set of particle positions and orientations, centered on the 6-fold symmetry axes, which we can later use for higher resolution reconstruction.</p>
<div class="section" id="particle-extraction">
<h2>Particle extraction<a class="headerlink" href="#particle-extraction" title="Permalink to this headline">¶</a></h2>
<p>Unless you already did it after <a class="reference external" href="hiv:extract-subset">extracting a subset of particles</a>, you will need to extract the whole dataset. Follow the <a class="reference internal" href="../../mini-tutorials/dynamo/extract-from-catalogue.html"><span class="doc std std-doc">same procedure</span></a>, but use all the volumes and use as a base name <code class="docutils literal notranslate"><span class="pre">findparticles</span></code>.</p>
</div>
<div class="section" id="particle-alignment">
<h2>Particle alignment<a class="headerlink" href="#particle-alignment" title="Permalink to this headline">¶</a></h2>
<p>Next we set up a new alignment project using <code class="docutils literal notranslate"><span class="pre">dcp</span></code>. This time, the aim is to align each oversampled initial particle position to the closest real particle position in the lattice. The important difference compared to the previous step are:</p>
<ul class="simple">
<li><p>Input data should be the whole dataset, not the subset, and the the relative <code class="docutils literal notranslate"><span class="pre">.tbl</span></code> file.</p></li>
<li><p>Template should now be the aligned, symmetrised initial model that we generated in the last section: <code class="docutils literal notranslate"><span class="pre">dynamo/inimodel/ite_0008/averages/average_aligned_along_z_c6.em</span></code>.</p></li>
<li><p>We only want to run for one iteration. Now that we’re working with the full dataset, calculations take significantly longer. Because our initial model is good one iteration of alignment should allow us to see the lattice structure appear in the particle positions.</p></li>
<li><p>We only want to perform local in plane and out of plane angular searches, since we are already fairly sure about our out of plane angles because they come from our <code class="docutils literal notranslate"><span class="pre">Vesicle</span></code> models. The in plane searches can be limited because of the C6 symmetry of the reference</p></li>
<li><p>We should adjust the shifts so that particles can only move half of the lattice spacing in the x and y direction. We expect to find a lattice of particles with roughly 7.5 nm spacing. If we allow each particle to shift a maximum of 4nm in each direction it should be guaranteed to find the closest true position in the lattice, without moving too far. This maximises the chances of finding all lattice positions from the beginning.</p></li>
<li><p>We should allow the particles to shift more in z than in x and y to account for any errors when defining our <code class="docutils literal notranslate"><span class="pre">Vesicle</span></code> models.</p></li>
</ul>
<a class="reference internal image-reference" href="../../_images/numerical-params2.png"><img alt="../../_images/numerical-params2.png" src="../../_images/numerical-params2.png" style="width: 500px;" /></a>
<p>Once the parameters are all set, run the project from the command line as before. This will take significantly longer that the previous time!</p>
</div>
<div class="section" id="cleaning-the-dataset-based-on-geometrical-constraints">
<h2>Cleaning the dataset based on geometrical constraints<a class="headerlink" href="#cleaning-the-dataset-based-on-geometrical-constraints" title="Permalink to this headline">¶</a></h2>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The provided scripts are just a few lines long, and are given for convenience and illustration purposes. You are encouraged to read them and modify them for your own purposes.</p>
</div>
</div>
<p>We can now take a look at the resulting particle positions, written in the output file <code class="docutils literal notranslate"><span class="pre">dynamo/findparticles/results/ite_0001/refined_table_ref_001_ite_0001.tbl</span></code>.</p>
<p>We can use <a class="reference external" href="https://github.com/teamtomo/teamtomo.github.io/tree/master/walkthroughs/EMPIAR-10164/scripts/view_particles.m"><code class="docutils literal notranslate"><span class="pre">view_particles.m</span></code></a>  to open a 3D viewer and examine them. Open matlab in <code class="docutils literal notranslate"><span class="pre">dynamo/findparticles/results/ite_0001/</span></code> and run:</p>
<div class="tabbed-set docutils">
<input checked="checked" id="f46de3a1-284c-4d48-bda8-b2c50b7a2700" name="d4da94a1-c346-40bf-bff9-e1baec586263" type="radio">
</input><label class="tabbed-label" for="f46de3a1-284c-4d48-bda8-b2c50b7a2700">
Command</label><div class="tabbed-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">view_particles</span><span class="p">(</span><span class="s">&#39;refined_table_ref_001_ite_0001.tbl&#39;</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<input id="16e1c77e-7ec8-41a4-b518-1d6983e83cba" name="d4da94a1-c346-40bf-bff9-e1baec586263" type="radio">
</input><label class="tabbed-label" for="16e1c77e-7ec8-41a4-b518-1d6983e83cba">
Source code</label><div class="tabbed-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span>gui<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">view_particles</span><span class="p">(</span>table<span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="c">% read the table</span><span class="w"></span>
<span class="w">    </span><span class="nb">table</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">dread</span><span class="p">(</span><span class="nb">table</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="c">% get unique keys of each volume</span><span class="w"></span>
<span class="w">    </span><span class="nb">keys</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">unique</span><span class="p">(</span><span class="nb">table</span><span class="p">(:,</span><span class="w"> </span><span class="mi">20</span><span class="p">));</span><span class="w"></span>

<span class="w">    </span><span class="c">% open the viewer gui</span><span class="w"></span>
<span class="w">    </span><span class="n">gui</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">mbgraph</span><span class="p">.</span><span class="n">montage</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c">% loop through volume keys</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">key_idx</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="nb">size</span><span class="p">(</span><span class="nb">keys</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">key</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">keys</span><span class="p">(</span><span class="n">key_idx</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="c">% extract the table corresponding to this volume</span><span class="w"></span>
<span class="w">        </span><span class="n">idx</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">table</span><span class="p">(:,</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">key_idx</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">subtable</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">table</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span><span class="w"> </span><span class="p">:);</span><span class="w"></span>
<span class="w">        </span><span class="c">% draw the particles as points and lines</span><span class="w"></span>
<span class="w">        </span><span class="n">ax</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">gui</span><span class="p">.</span><span class="n">gca</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">sketch</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">dpktbl</span><span class="p">.</span><span class="n">plots</span><span class="p">.</span><span class="n">sketch</span><span class="p">(</span><span class="n">subtable</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;haxis&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">ax</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="c">% create a new frame for the next volume</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">key_idx</span><span class="o">~=</span><span class="nb">size</span><span class="p">(</span><span class="nb">keys</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">gui</span><span class="p">.</span><span class="n">step</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">end</span><span class="w"></span>
<span class="w">    </span><span class="k">end</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can pan around the view by drag-n-dropping, zoom by scrolling, and change volume by clicking the <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> buttons.</p>
</div>
</div>
<a class="reference internal image-reference" href="../../_images/particle-positions.png"><img alt="../../_images/particle-positions.png" src="../../_images/particle-positions.png" style="width: 600px;" /></a>
<p>As you can see, there are regions where particle positions appear to form regular lattices, and other smaller, more irregular regions. These disordered patches are likely due to irregularities in the VLP we annotated. To avoid including particles which do not contain our lattice structure, we should try to remove these particles at this stage.</p>
<p>However, the first cleaning step we should take is removing duplicate particles (remember, we oversampled the surface compared to the expected particle density!). To do so, we will use a simple matlab script, <a class="reference external" href="https://github.com/teamtomo/teamtomo.github.io/tree/master/walkthroughs/EMPIAR-10164/scripts/remove_duplicates.m"><code class="docutils literal notranslate"><span class="pre">remove_duplicates.m</span></code></a>.</p>
<p>To run, simply open MATLAB in <code class="docutils literal notranslate"><span class="pre">dynamo/findparticles/results/ite_0001/averages</span></code> and run:</p>
<div class="tabbed-set docutils">
<input checked="checked" id="416b9009-ea46-459c-8942-9e43a78f5ce6" name="9f781bae-08c4-4ae2-9823-f315903d7c26" type="radio">
</input><label class="tabbed-label" for="416b9009-ea46-459c-8942-9e43a78f5ce6">
Command</label><div class="tabbed-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">remove_duplicates</span><span class="w"></span>
</pre></div>
</div>
</div>
<input id="6c23c3c1-76a7-4df4-9f04-4ce211022f23" name="9f781bae-08c4-4ae2-9823-f315903d7c26" type="radio">
</input><label class="tabbed-label" for="6c23c3c1-76a7-4df4-9f04-4ce211022f23">
Source code</label><div class="tabbed-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% read table</span><span class="w"></span>
<span class="nb">table</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">dread</span><span class="p">(</span><span class="s">&#39;refined_table_ref_001_ite_0001.tbl&#39;</span><span class="p">);</span><span class="w"></span>

<span class="c">% remove duplicates</span><span class="w"></span>
<span class="n">threshold</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="n">nodup</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">dpktbl</span><span class="p">.</span><span class="n">exclusionPerVolume</span><span class="p">(</span><span class="nb">table</span><span class="p">,</span><span class="w"> </span><span class="n">threshold</span><span class="p">)</span><span class="w"></span>

<span class="c">% write out table</span><span class="w"></span>
<span class="n">dwrite</span><span class="p">(</span><span class="n">nodup</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;result_10Apx_nodup.tbl&#39;</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>This will create a new table called <code class="docutils literal notranslate"><span class="pre">result_10Apx_nodup.tbl</span></code>, reducing clusters of multiple particles within 4 pixels (half the distance we measured earlier) to a single particle.</p>
<p>The next step is to remove particles that don’t belong to the lattice. To do so, we use <a class="reference external" href="https://github.com/teamtomo/teamtomo.github.io/tree/master/walkthroughs/EMPIAR-10164/scripts/check_radial_distribution.m"><code class="docutils literal notranslate"><span class="pre">check_radial_distribution.m</span></code></a>.</p>
<p>Once again, in the same directory, simply run:</p>
<div class="tabbed-set docutils">
<input checked="checked" id="3ef6cea3-b901-4b3d-b57b-d8ed65acb46f" name="dd32739d-d4e9-47eb-a81a-b90f3206abd1" type="radio">
</input><label class="tabbed-label" for="3ef6cea3-b901-4b3d-b57b-d8ed65acb46f">
Command</label><div class="tabbed-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">check_radial_distribution</span><span class="w"></span>
</pre></div>
</div>
</div>
<input id="29779edc-166f-4957-83c2-632505c214cd" name="dd32739d-d4e9-47eb-a81a-b90f3206abd1" type="radio">
</input><label class="tabbed-label" for="29779edc-166f-4957-83c2-632505c214cd">
Source code</label><div class="tabbed-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% check number of neighbours in radial shells, 1 px thick shells</span><span class="w"></span>

<span class="c">% read table</span><span class="w"></span>
<span class="nb">table</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">dread</span><span class="p">(</span><span class="s">&#39;result_10Apx_nodup.tbl&#39;</span><span class="p">);</span><span class="w"></span>

<span class="c">% check average number of neighbours in shells</span><span class="w"></span>
<span class="c">% initialise result vector</span><span class="w"></span>
<span class="n">neighbours_in_shells</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="n">shell_starts</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">19</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">);</span><span class="w"></span>

<span class="c">% check number of neighbours in shell, count and append to result</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="n">shell_start_idx</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="nb">size</span><span class="p">(</span><span class="n">shell_starts</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">min_dist</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">shell_starts</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">shell_start_idx</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">max_dist</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">min_dist</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">n_neighbours</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">dtneighbours_in_range</span><span class="p">(</span><span class="nb">table</span><span class="p">,</span><span class="w"> </span><span class="n">min_dist</span><span class="p">,</span><span class="w"> </span><span class="n">max_dist</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">neighbours_in_shells</span><span class="p">(</span><span class="n">shell_start_idx</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">mean</span><span class="p">(</span><span class="n">n_neighbours</span><span class="p">);</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>

<span class="nb">plot</span><span class="p">(</span><span class="n">shell_starts</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">neighbours_in_shells</span><span class="p">)</span><span class="w"></span>

<span class="c">% plot shows most particles have more neighbours at 5.5-8.5px distance</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>This will open a plot of the radial distribution of neighbouring particles for the whole dataset. Here, we can see a high peak at around 7.5 px, and periodic peaks after that.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are wondering why the second peak has two sub-peaks: it’s the honeycomb pattern! The second shell of neighbours is actually composed of two shells at slighly different distances.</p>
</div>
</div>
<p><img alt="radial distribution" src="../../_images/radial-distance-profile.png" /></p>
<p>This confirms the previously measured interparticle distance and the fact that most particles slid into ordered positions in the lattice. We can use the first peak to select against particles that don’t conform to this distribution. The next script, <a class="reference external" href="https://github.com/teamtomo/teamtomo.github.io/tree/master/walkthroughs/EMPIAR-10164/scripts/subset_table_based_on_neighbours.m"><code class="docutils literal notranslate"><span class="pre">subset_table_based_on_neighbours.m</span></code></a>, removes all particles that don’t have at least 3 neighbours in the radial shell at distance 7.5 px. To use it, run:</p>
<div class="tabbed-set docutils">
<input checked="checked" id="ca29bf0f-2d66-49ff-b74e-1064d0919f1c" name="d2f1a418-5cc6-4d91-bfbe-3ec48ee10c8a" type="radio">
</input><label class="tabbed-label" for="ca29bf0f-2d66-49ff-b74e-1064d0919f1c">
Command</label><div class="tabbed-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">subset_table_based_on_neighbours</span><span class="w"></span>
</pre></div>
</div>
</div>
<input id="f1c97273-cc11-46fe-9927-dfdaf1d7c171" name="d2f1a418-5cc6-4d91-bfbe-3ec48ee10c8a" type="radio">
</input><label class="tabbed-label" for="f1c97273-cc11-46fe-9927-dfdaf1d7c171">
Source code</label><div class="tabbed-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">read</span> <span class="n">table</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">dread</span><span class="p">(</span><span class="s1">&#39;result_10Apx_nodup.tbl&#39;</span><span class="p">);</span>

<span class="o">%</span> <span class="n">calculate</span> <span class="n">neighbours</span> <span class="n">around</span> <span class="n">peak</span> <span class="n">at</span> <span class="mf">7.5</span><span class="n">px</span>
<span class="n">peak</span> <span class="o">=</span> <span class="mf">7.5</span><span class="p">;</span>
<span class="n">delta</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">neighbours</span> <span class="o">=</span> <span class="n">dtneighbours_in_range</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">peak</span><span class="o">-</span><span class="n">delta</span><span class="p">,</span> <span class="n">peak</span><span class="o">+</span><span class="n">delta</span><span class="p">);</span>

<span class="o">%</span> <span class="n">see</span> <span class="n">which</span> <span class="n">particles</span> <span class="n">have</span> <span class="n">more</span> <span class="n">than</span> <span class="mi">3</span> <span class="n">neighbours</span><span class="p">,</span> <span class="n">save</span> <span class="k">as</span> <span class="n">indices</span> <span class="n">to</span>
<span class="o">%</span> <span class="n">access</span> <span class="n">table</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">neighbours</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">;</span>
<span class="n">subset</span> <span class="o">=</span> <span class="n">table</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="p">:);</span>

<span class="o">%</span> <span class="n">write</span> <span class="n">out</span> <span class="n">table</span>
<span class="n">dwrite</span><span class="p">(</span><span class="n">subset</span><span class="p">,</span> <span class="s1">&#39;result_10Apx_nodup_neighbourcleaning.tbl&#39;</span><span class="p">);</span>
<span class="n">compare_two_tables</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">subset</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>When finished, the script will open a viewer to inspect the table before and after the processing. Switching to a less clean dataset (for example <code class="docutils literal notranslate"><span class="pre">TS_43</span></code>) will make it clear that most bad particles were removed.</p>
<p>The final output is a new table called <code class="docutils literal notranslate"><span class="pre">result_10Apx_nodup_neighbourcleaning.tbl</span></code> which contains only references to the particles that we selected. This is our cleaned dataset, ready for refinement in <code class="docutils literal notranslate"><span class="pre">RELION</span></code>!</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./walkthroughs/EMPIAR-10164"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="ini-model.html" title="previous page">Initial model generation</a>
    <a class='right-next' id="next-link" href="relion.html" title="next page">Particle pose optimisation</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By the teamtomo.org contributors<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>